---
title: Spring Cloud 微服务全栈技术与案例解析
sidebar: auto
---

在适用`@Async`注解后，还需在启动类上加上`@EnableAsync`的注解，对于异步线程池，我们可以实现`AsyncConfigurer`来进行自定义配置

异步线程池有两种拒绝策略：

-   AbortPolicy：直接抛出异常
-   CallerRunsPolicy：主线程直接执行该任务，执行万之后尝试添加下一个任务刀线程池中，这样可以有效的降低向线程池内添加任务的速度

限流算法：

1. 令牌桶
2. 漏桶

Guava Cache 的优点：

-   本地缓存，读取效率高，不受网络因素影响
-   拥有丰富的功能，操作简单
-   线程安全

Guava Cache 的不足之处：

-   缓存为本地缓存，不能持久化数据
-   单机缓存，受机器内存限制，应用重启会数据会丢失
-   分布式部署时无法保证数据的一致性

常用的分片算法：

-   范围分片
-   取模分片
-   Hash 分片
-   时间分片

常见的分布式 Id 生成方式

-   采用 Twitter Snowflake 算法实现
-   更加机器名称最后的数字编号取得工作进程 id
-   更加机器 ip 获取工作进程 id，如果线程机器的 ip 二进制表示的最后 10 位不重复，建议使用此种方式
